appId: com.kangfenmao.CherryStudio
productName: Cherry Studio
electronLanguages:
  - zh-CN
  - zh-TW
  - en-US
  - ja # macOS/linux/win
  - ru # macOS/linux/win
  - zh_CN # for macOS
  - zh_TW # for macOS
  - en # for macOS
  - de
directories:
  buildResources: build

protocols:
  - name: Cherry Studio
    schemes:
      - cherrystudio
files:
  - "**/*"
  - "!**/{.vscode,.yarn,.yarn-lock,.github,.cursorrules,.prettierrc}"
  - "!electron.vite.config.{js,ts,mjs,cjs}}"
  - "!.*"
  - "!components.json"
  - "!**/{.eslintignore,.eslintrc.js,.eslintrc.json,.eslintcache,root.eslint.config.js,eslint.config.js,.eslintrc.cjs,.prettierignore,.prettierrc.yaml,eslint.config.mjs,dev-app-update.yml,CHANGELOG.md,README.md,biome.jsonc}"
  - "!**/{.env,.env.*,.npmrc,pnpm-lock.yaml}"
  - "!**/{tsconfig.json,tsconfig.tsbuildinfo,tsconfig.node.json,tsconfig.web.json}"
  - "!**/{.editorconfig,.jekyll-metadata}"
  - "!src"
  - "!config"
  - "!patches"
  - "!app-upgrade-config.json"
  - "!**/node_modules/**/*.cpp"
  - "!**/node_modules/node-addon-api/**"
  - "!**/node_modules/prebuild-install/**"
  - "!scripts"
  - "!local"
  - "!docs"
  - "!packages"
  - "!.swc"
  - "!.bin"
  - "!._*"
  - "!*.log"
  - "!stats.html"
  - "!*.md"
  - "!**/*.{iml,o,hprof,orig,pyc,pyo,rbc,swp,csproj,sln,xproj}"
  - "!**/*.{map,ts,tsx,jsx,less,scss,sass,css.d.ts,d.cts,d.mts,md,markdown,yaml,yml}"
  - "!**/{test,tests,__tests__,powered-test,coverage}/**"
  - "!**/{example,examples}/**"
  - "!**/*.{spec,test}.{js,jsx,ts,tsx}"
  - "!**/*.min.*.map"
  - "!**/*.d.ts"
  - "!**/dist/es6/**"
  - "!**/dist/demo/**"
  - "!**/amd/**"
  - "!**/{.DS_Store,Thumbs.db,thumbs.db,__pycache__}"
  - "!**/{LICENSE,license,LICENSE.*,*.LICENSE.txt,NOTICE.txt,README.md,readme.md,CHANGELOG.md}"
  - "!node_modules/rollup-plugin-visualizer"
  - "!node_modules/js-tiktoken"
  - "!node_modules/@tavily/core/node_modules/js-tiktoken"
  - "!node_modules/pdf-parse/lib/pdf.js/{v1.9.426,v1.10.88,v2.0.550}"
  - "!node_modules/mammoth/{mammoth.browser.js,mammoth.browser.min.js}"
  - "!node_modules/selection-hook/prebuilds/**/*" # we rebuild .node, don't use prebuilds
  - "!node_modules/selection-hook/node_modules" # we don't need what in the node_modules dir
  - "!node_modules/selection-hook/src" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core.js,tesseract-core.wasm,tesseract-core.wasm.js}" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core-lstm.js,tesseract-core-lstm.wasm,tesseract-core-lstm.wasm.js}" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core-simd-lstm.js,tesseract-core-simd-lstm.wasm,tesseract-core-simd-lstm.wasm.js}" # we don't need source files
  - "!**/*.{h,iobj,ipdb,tlog,recipe,vcxproj,vcxproj.filters,Makefile,*.Makefile}" # filter .node build files
asarUnpack:
  - resources/**
  - "**/*.{metal,exp,lib}"
  - "node_modules/@img/sharp-libvips-*/**"

win:
  executableName: Cherry Studio
  artifactName: ${productName}-${version}-${arch}-setup.${ext}
  target:
    - target: nsis
    - target: portable
  signtoolOptions:
    sign: scripts/win-sign.js
  verifyUpdateCodeSignature: false
nsis:
  artifactName: ${productName}-${version}-${arch}-setup.${ext}
  shortcutName: ${productName}
  uninstallDisplayName: ${productName}
  createDesktopShortcut: always
  allowToChangeInstallationDirectory: true
  oneClick: false
  include: build/nsis-installer.nsh
  buildUniversalInstaller: false
  differentialPackage: false
portable:
  artifactName: ${productName}-${version}-${arch}-portable.${ext}
  buildUniversalInstaller: false
mac:
  entitlementsInherit: build/entitlements.mac.plist
  notarize: false
  artifactName: ${productName}-${version}-${arch}.${ext}
  extendInfo:
    - NSCameraUsageDescription: Application requests access to the device's camera.
    - NSMicrophoneUsageDescription: Application requests access to the device's microphone.
    - NSDocumentsFolderUsageDescription: Application requests access to the user's Documents folder.
    - NSDownloadsFolderUsageDescription: Application requests access to the user's Downloads folder.
  target:
    - target: dmg
    - target: zip
dmg:
  writeUpdateInfo: false
linux:
  artifactName: ${productName}-${version}-${arch}.${ext}
  executableName: CherryStudio
  target:
    - target: AppImage
    - target: deb
    - target: rpm
  maintainer: electronjs.org
  category: Utility
  desktop:
    entry:
      Name: Cherry Studio
      StartupWMClass: CherryStudio
  mimeTypes:
    - x-scheme-handler/cherrystudio
rpm:
  # Workaround for electron build issue on rpm package:
  # https://github.com/electron/forge/issues/3594
  fpm: ["--rpm-rpmbuild-define=_build_id_links none"]
publish:
  provider: generic
  url: https://releases.cherry-ai.com
electronDownload:
  mirror: https://npmmirror.com/mirrors/electron/
beforePack: scripts/before-pack.js
afterPack: scripts/after-pack.js
afterSign: scripts/notarize.js
artifactBuildCompleted: scripts/artifact-build-completed.js
releaseInfo:
  releaseNotes: |
    <!--LANG:en-->
    Cherry Studio 1.7.18 - New Features & Bug Fixes

    âœ¨ New Features
    - [Agent] Add AskUserQuestion tool renderer for agent tools
    - [Models] Add Claude Opus 4.6 model support
    - [Models] Add PPIO painting models
    - [Chat] Add export to Excel button for markdown tables
    - [Settings] Use CodeEditor for JSON custom parameters with lint feedback
    - [Analytics] Integrate analytics-client for token usage tracking
    - [OpenClaw] Improve install path display with copy button; isolate config to separate file

    ğŸ› Bug Fixes
    - [Windows] Avoid EPERM by removing .tmp+rename in PluginInstaller
    - [Windows] Prevent MAX_PATH errors
    - [Windows] Use refreshed shell environment for executable detection
    - [Agent] Move agents.db into Data/ directory for backup consistency
    - [Agent] Fix scroll to bottom when sending agent messages
    - [Agent] Improve language instruction for Claude Code agent
    - [Reasoning] Add qwen3-max to supported reasoning models
    - [Reasoning] Normalize Fireworks model IDs for reasoning detection
    - [Codeblock] Fix copy modified content after edit
    - [Chat] Fall back to first message text when topic naming fails
    - [Chat] Add block-level ErrorBoundary to prevent dirty data crashes
    - [Models] Handle Gemini OpenAI-compatible thought signatures and missing tool_call index
    - [Models] Correct openai-compatible strictJsonSchema patch
    - [MCP] Escape double quotes in tool use prompt examples
    - [OCR] Support PP-OCRv5 response and handle corrupted PDF in PaddleOCR
    - [Build] Pin @uiw/codemirror-extensions-langs to 4.25.1 to fix production build

    âš¡ Performance
    - Remove unused Redux state cache in main process

    <!--LANG:zh-CN-->
    Cherry Studio 1.7.18 - æ–°åŠŸèƒ½ä¸é—®é¢˜ä¿®å¤

    âœ¨ æ–°åŠŸèƒ½
    - [æ™ºèƒ½ä½“] æ–°å¢ AskUserQuestion å·¥å…·æ¸²æŸ“å™¨
    - [æ¨¡å‹] æ–°å¢ Claude Opus 4.6 æ¨¡å‹æ”¯æŒ
    - [æ¨¡å‹] æ–°å¢ PPIO ç»˜ç”»æ¨¡å‹
    - [å¯¹è¯] Markdown è¡¨æ ¼æ–°å¢å¯¼å‡ºä¸º Excel æŒ‰é’®
    - [è®¾ç½®] è‡ªå®šä¹‰ JSON å‚æ•°ä½¿ç”¨ä»£ç ç¼–è¾‘å™¨å¹¶æ”¯æŒ lint åé¦ˆ
    - [åˆ†æ] é›†æˆ analytics-client ç”¨äº Token ç”¨é‡è¿½è¸ª
    - [OpenClaw] æ”¹è¿›å®‰è£…è·¯å¾„æ˜¾ç¤ºï¼Œæ–°å¢å¤åˆ¶æŒ‰é’®ï¼›é…ç½®ç‹¬ç«‹ä¸ºå•ç‹¬æ–‡ä»¶

    ğŸ› é—®é¢˜ä¿®å¤
    - [Windows] ä¿®å¤ PluginInstaller ä¸­ .tmp é‡å‘½åå¯¼è‡´çš„ EPERM é”™è¯¯
    - [Windows] ä¿®å¤ MAX_PATH è·¯å¾„è¿‡é•¿é”™è¯¯
    - [Windows] ä¿®å¤å¯æ‰§è¡Œæ–‡ä»¶æ£€æµ‹æ—¶ shell ç¯å¢ƒæœªåˆ·æ–°çš„é—®é¢˜
    - [æ™ºèƒ½ä½“] å°† agents.db ç§»è‡³ Data/ ç›®å½•ä»¥ä¿æŒå¤‡ä»½ä¸€è‡´æ€§
    - [æ™ºèƒ½ä½“] ä¿®å¤å‘é€æ™ºèƒ½ä½“æ¶ˆæ¯æ—¶ä¸è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨çš„é—®é¢˜
    - [æ™ºèƒ½ä½“] æ”¹è¿› Claude Code æ™ºèƒ½ä½“çš„è¯­è¨€æŒ‡ä»¤
    - [æ¨ç†] æ–°å¢ qwen3-max æ¨ç†æ¨¡å‹æ”¯æŒ
    - [æ¨ç†] ä¿®å¤ Fireworks æ¨¡å‹ ID çš„æ¨ç†æ£€æµ‹è§„èŒƒåŒ–
    - [ä»£ç å—] ä¿®å¤ç¼–è¾‘åå¤åˆ¶å†…å®¹ä¸æ­£ç¡®çš„é—®é¢˜
    - [å¯¹è¯] è¯é¢˜å‘½åå¤±è´¥æ—¶å›é€€åˆ°é¦–æ¡æ¶ˆæ¯æ–‡æœ¬
    - [å¯¹è¯] æ–°å¢å—çº§ ErrorBoundary é˜²æ­¢è„æ•°æ®å¯¼è‡´å´©æºƒ
    - [æ¨¡å‹] ä¿®å¤ Gemini OpenAI å…¼å®¹æ¨¡å¼ä¸‹çš„æ€ç»´ç­¾åå’Œç¼ºå¤±çš„ tool_call index
    - [æ¨¡å‹] ä¿®å¤ openai-compatible strictJsonSchema è¡¥ä¸
    - [MCP] ä¿®å¤å·¥å…·ä½¿ç”¨æç¤ºä¸­åŒå¼•å·æœªè½¬ä¹‰çš„é—®é¢˜
    - [OCR] æ”¯æŒ PP-OCRv5 å“åº”æ ¼å¼å¹¶å¤„ç† PaddleOCR ä¸­æŸåçš„ PDF
    - [æ„å»º] å›ºå®š @uiw/codemirror-extensions-langs ç‰ˆæœ¬ä¸º 4.25.1 ä»¥ä¿®å¤ç”Ÿäº§æ„å»º

    âš¡ æ€§èƒ½ä¼˜åŒ–
    - ç§»é™¤ä¸»è¿›ç¨‹ä¸­æœªä½¿ç”¨çš„ Redux çŠ¶æ€ç¼“å­˜
    <!--LANG:END-->
